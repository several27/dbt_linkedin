{
  "id" : "linkedin_ads__campaign_report",
  "metainfo" : {
    "label" : "linkedin_ads__campaign_report",
    "autoLayout" : true,
    "staleState" : "none",
    "sourceSuggestions" : {
      "sources" : [ ]
    },
    "version" : 3
  },
  "processes" : {
    "pRTNGapj" : {
      "id" : "pRTNGapj",
      "component" : "TargetModel",
      "metadata" : {
        "label" : "linkedin_ads__campaign_report",
        "phase" : 0
      },
      "properties" : {
        "customQueryDisabled" : true,
        "customQuery" : true,
        "incrementalEditorDisabled" : true,
        "query" : "{{ config(enabled=var('ad_reporting__linkedin_ads_enabled', True)) }}\n\nwith campaign as (\n\n    select *\n    from {{ var('campaign_history') }}\n    where is_latest_version\n),\n\ncampaign_group as (\n\n    select *\n    from {{ var('campaign_group_history') }}\n    where is_latest_version\n),\n\naccount as (\n\n    select *\n    from {{ var('account_history') }}\n    where is_latest_version\n),\n\nreport as (\n\n    select *\n    from {{ var('ad_analytics_by_campaign') }}\n),\n\nfinal as (\n\n    select \n        report.source_relation,\n        report.date_day,\n        report.campaign_id,\n        campaign.campaign_name,\n        campaign.version_tag,\n        campaign_group.campaign_group_id,\n        campaign_group.campaign_group_name,\n        account.account_id,\n        account.account_name,\n        campaign.status as campaign_status,\n        campaign_group.status as campaign_group_status,\n        campaign.type,\n        campaign.cost_type,\n        campaign.creative_selection,\n        campaign.daily_budget_amount,\n        campaign.daily_budget_currency_code,\n        campaign.unit_cost_amount,\n        campaign.unit_cost_currency_code,\n        account.currency,\n        campaign.format,\n        campaign.locale_country,\n        campaign.locale_language,\n        campaign.objective_type,\n        campaign.optimization_target_type,\n        campaign.is_audience_expansion_enabled,\n        campaign.is_offsite_delivery_enabled,\n        campaign.run_schedule_start_at,\n        campaign.run_schedule_end_at,\n        campaign.last_modified_at,\n        campaign.created_at,\n        sum(report.clicks) as clicks,\n        sum(report.impressions) as impressions,\n        sum(report.cost) as cost\n\n        {{ fivetran_utils.persist_pass_through_columns('linkedin_ads__campaign_passthrough_metrics', transform='sum') }}\n    \n    from report \n    left join campaign \n        on report.campaign_id = campaign.campaign_id\n        and report.source_relation = campaign.source_relation\n    left join campaign_group\n        on campaign.campaign_group_id = campaign_group.campaign_group_id\n        and campaign.source_relation = campaign_group.source_relation\n    left join account \n        on campaign.account_id = account.account_id\n        and campaign.source_relation = account.source_relation\n\n    {{ dbt_utils.group_by(30) }}\n\n)\n\nselect *\nfrom final",
        "isModel" : true,
        "incrementalKey" : false,
        "incremental" : {
          "expression" : "true"
        }
      },
      "ports" : {
        "inputs" : [ ],
        "outputs" : [ {
          "id" : "ermQo5qH",
          "slug" : "out"
        } ],
        "isCustomOutputSchema" : true,
        "autoUpdateOnRun" : true
      }
    }
  },
  "connections" : [ ],
  "component" : "Model"
}